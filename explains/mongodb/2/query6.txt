{ "stages" : [{ "$cursor" : { "query" : { "sensorId" : { "$in" : ["thermometer1", "thermometer5", "thermometer7"] }, "timeStamp" : { "$gt" : { "$date" : 1509519600000 }, "$lt" : { "$date" : 1510060210000 } } }, "fields" : { "sensorId" : 1, "timeStamp" : 1, "_id" : 0 }, "queryPlanner" : { "plannerVersion" : 1, "namespace" : "TippersDB.Observation", "indexFilterSet" : false, "parsedQuery" : { "$and" : [{ "timeStamp" : { "$lt" : { "$date" : 1510060210000 } } }, { "timeStamp" : { "$gt" : { "$date" : 1509519600000 } } }, { "sensorId" : { "$in" : ["thermometer1", "thermometer5", "thermometer7"] } }] }, "winningPlan" : { "stage" : "FETCH", "filter" : { "sensorId" : { "$in" : ["thermometer1", "thermometer5", "thermometer7"] } }, "inputStage" : { "stage" : "IXSCAN", "keyPattern" : { "timeStamp" : 1 }, "indexName" : "timeStamp_1", "isMultiKey" : false, "multiKeyPaths" : { "timeStamp" : [] }, "isUnique" : false, "isSparse" : false, "isPartial" : false, "indexVersion" : 2, "direction" : "forward", "indexBounds" : { "timeStamp" : ["(new Date(1509519600000), new Date(1510060210000))"] } } }, "rejectedPlans" : [] } } }, { "$project" : { "_id" : false, "sensorId" : true, "date" : { "$dateToString" : { "format" : "%Y-%m-%d", "date" : "$timeStamp" } } } }, { "$group" : { "_id" : { "sensorId" : "$sensorId", "date" : "$date" }, "count" : { "$sum" : { "$const" : 1 } } } }, { "$group" : { "_id" : { "sensorId" : "$_id.sensorId" }, "averagePerDay" : { "$avg" : "$count" } } }], "ok" : 1.0 }
